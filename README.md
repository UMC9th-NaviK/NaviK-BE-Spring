# Na:viK Backend

### AI ê¸°ë°˜ ì»¤ë¦¬ì–´ ì„±ì¥ ì¶”ì  í”Œë«í¼ 'Na:viK' ì˜ ë°±ì—”ë“œ ì„œë²„ì…ë‹ˆë‹¤!

# ğŸ“ í”„ë¡œì íŠ¸ ì†Œê°œ

**Navik**ì€ ì£¼ë‹ˆì–´ ê°œë°œìê°€ ìì‹ ì˜ ì„±ì¥ì„ ì²´ê³„ì ìœ¼ë¡œ ê¸°ë¡í•˜ê³ , AIë¥¼ í™œìš©í•´ ì—­ëŸ‰ì„ ë¶„ì„ë°›ìœ¼ë©°, ë§ì¶¤í˜• ì±„ìš© ê³µê³ ì™€ ìŠ¤í„°ë””ë¥¼ ì¶”ì²œë°›ì„ ìˆ˜ ìˆëŠ” ì»¤ë¦¬ì–´ ì„±ì¥ í”Œë«í¼ì…ë‹ˆë‹¤.
![img_4.png](img_4.png)
![img_3.png](img_3.png)

### ğŸ” Why?

- ì„±ì¥ ê¸°ë¡ì´ íŒŒí¸í™”ë˜ì–´ ìˆì–´ ë³¸ì¸ì˜ ì—­ëŸ‰ ë³€í™”ë¥¼ íŒŒì•…í•˜ê¸° ì–´ë µìŠµë‹ˆë‹¤.
- ì§ë¬´ë³„ í•µì‹¬ ì—­ëŸ‰(KPI)ê³¼ ë‚´ í˜„ì¬ ìˆ˜ì¤€ì˜ ê°­ì„ ê°ê´€ì ìœ¼ë¡œ íŒŒì•…í•  ìˆ˜ ì—†ëŠ” ì–´ë ¤ì›€ì´ ìˆìŠµë‹ˆë‹¤.
- ì±„ìš© ê³µê³ Â·ìŠ¤í„°ë””ë¥¼ ì§ì ‘ ì°¾ì•„ì•¼ í•´ì„œ ì‹œê°„ì´ ë§ì´ ë“­ë‹ˆë‹¤.

### ğŸ” What?

- ì„±ì¥ ë¡œê·¸ë¥¼ ì‘ì„±í•˜ë©´ AIê°€ ì§ë¬´ KPI ê¸°ì¤€ìœ¼ë¡œ í‰ê°€í•´ ì ìˆ˜ë¥¼ ë§¤ê¸´ë‹¤
- í¬íŠ¸í´ë¦¬ì˜¤ë¥¼ ì—…ë¡œë“œí•˜ë©´ AIê°€ ë¶„ì„í•´ ê°•ì Â·ì•½ì ì„ ë„ì¶œí•œë‹¤
- ë²¡í„° ìœ ì‚¬ë„ ê¸°ë°˜ìœ¼ë¡œ ë‚´ ì—­ëŸ‰ì— ë§ëŠ” ì±„ìš© ê³µê³ Â·ìŠ¤í„°ë””ë¥¼ ìë™ ì¶”ì²œí•œë‹¤

## Features

| ê¸°ëŠ¥           | ì„¤ëª…                                              |
|--------------|-------------------------------------------------|
| **ì„±ì¥ ë¡œê·¸**    | í™œë™Â·í•™ìŠµÂ·ì„±ê³¼ë¥¼ ê¸°ë¡í•˜ê³  AI í‰ê°€(ë¹„ë™ê¸° Worker)ë¥¼ ë°›ì•„ KPI ì ìˆ˜ì— ë°˜ì˜ |
| **í¬íŠ¸í´ë¦¬ì˜¤ ë¶„ì„** | PDF/í…ìŠ¤íŠ¸ í¬íŠ¸í´ë¦¬ì˜¤ ì—…ë¡œë“œ â†’ AI ë¶„ì„ â†’ ê°•ì Â·ì•½ì  ë¦¬í¬íŠ¸           |
| **KPI ì¹´ë“œ**   | ì§ë¬´ë³„ í•µì‹¬ ì—­ëŸ‰ ì¹´ë“œì™€ ë ˆì´ë” ì°¨íŠ¸ë¡œ ë‚´ ì—­ëŸ‰ ì‹œê°í™”                  |
| **ì±„ìš© ì¶”ì²œ**    | pgvector ê¸°ë°˜ ë²¡í„° ìœ ì‚¬ë„ë¡œ ë‚´ KPIì— ë§ëŠ” ì±„ìš© ê³µê³  ìë™ ë§¤ì¹­       |
| **ìŠ¤í„°ë””**      | ìŠ¤í„°ë”” ìƒì„±Â·ì°¸ì—¬Â·ë™ë£Œ í‰ê°€, KPI ìœ ì‚¬ë„ ê¸°ë°˜ ìŠ¤í„°ë”” ì¶”ì²œ              |
| **ì»¤ë®¤ë‹ˆí‹°**     | ì§ë¬´ë³„ ê²Œì‹œíŒ, ëŒ“ê¸€, ì¢‹ì•„ìš”, ì¸ê¸°ê¸€ ë­í‚¹                        |
| **ì†Œì…œ ë¡œê·¸ì¸**   | Google Â· Kakao Â· Naver OAuth2 ì§€ì›                |

## Demo

- **Production**: `http://www.navik.kr`

## Tech Stack

| ë¶„ë¥˜             | ê¸°ìˆ                                            |
|----------------|----------------------------------------------|
| Language       | Java 21                                      |
| Framework      | Spring Boot 3.5.9                            |
| Database       | PostgreSQL + pgvector                        |
| Cache / Stream | Redis                                        |
| ORM            | Spring Data JPA + QueryDSL 5.1.0             |
| Auth           | Spring Security + OAuth2 + JWT (JJWT 0.12.3) |
| Storage        | AWS S3                                       |
| Vector Search  | Hibernate Vector 6.6                         |
| API Docs       | springdoc-openapi 2.8.5 (Swagger UI)         |
| Monitoring     | Spring Actuator + Prometheus + Micrometer    |
| CI/CD          | GitHub Actions â†’ AWS ECR â†’ EC2               |
| Container      | Docker (eclipse-temurin:21-jre)              |

## Getting Started

### Requirements

- **Java 21** (Eclipse Temurin ê¶Œì¥)
- **PostgreSQL 15+** (pgvector í™•ì¥ í•„ìš”)
- **Redis 7+**
- **Gradle 8+** (Wrapper í¬í•¨)

### Installation

```bash
git clone https://github.com/your-org/navik-be.git
cd navik-be
```

### Configuration

í”„ë¡œì íŠ¸ ë£¨íŠ¸ì— `.env` íŒŒì¼ì„ ìƒì„±í•˜ê³  ì•„ë˜ ë³€ìˆ˜ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤.

```dotenv
# Database
DB_URL=jdbc:postgresql://localhost:5432/navik
DB_USER=myuser
DB_PASSWORD=mypassword

# Redis
REDIS_HOST=localhost
REDIS_PORT=6379

# JWT
JWT_SECRET=your-jwt-secret-key-at-least-256-bits

# OAuth2 (ì†Œì…œ ë¡œê·¸ì¸)
GOOGLE_CLIENT_ID=your-google-client-id
GOOGLE_CLIENT_SECRET=your-google-client-secret
KAKAO_CLIENT_ID=your-kakao-client-id
KAKAO_CLIENT_SECRET=your-kakao-client-secret
NAVER_CLIENT_ID=your-naver-client-id
NAVER_CLIENT_SECRET=your-naver-client-secret

# AWS S3
AWS_REGION=ap-northeast-2
AWS_S3_BUCKET=your-bucket-name

# AI Server
AI_SERVER_BASE_URL=http://localhost:8081

# Notion OAuth (ì„ íƒ)
NOTION_OAUTH_CLIENT_ID=your-notion-client-id
NOTION_OAUTH_CLIENT_SECRET=your-notion-client-secret
```

### Database Setup

```bash
# PostgreSQLì—ì„œ ë°ì´í„°ë² ì´ìŠ¤ ë° pgvector í™•ì¥ ìƒì„±
psql -U myuser -c "CREATE DATABASE navik;"
psql -U myuser -d navik -c "CREATE EXTENSION IF NOT EXISTS vector;"
```

> dev í”„ë¡œí•„ì—ì„œëŠ” `spring.jpa.hibernate.ddl-auto=update`ë¡œ ìŠ¤í‚¤ë§ˆê°€ ìë™ ìƒì„±ë©ë‹ˆë‹¤.

### Run

```bash
# Gradle Wrapperë¡œ ì‹¤í–‰
./gradlew bootRun

# ë˜ëŠ” JAR ë¹Œë“œ í›„ ì‹¤í–‰
./gradlew clean bootJar -x test
java -jar build/libs/navik-app-1.0.0.jar
```

ì„œë²„ê°€ ì‹œì‘ë˜ë©´ `http://localhost:8080/swagger-ui/index.html`ì—ì„œ APIë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### Docker

```bash
# JAR ë¨¼ì € ë¹Œë“œ
./gradlew clean bootJar -x test

# Docker ì´ë¯¸ì§€ ë¹Œë“œ ë° ì‹¤í–‰
docker build -t navik-backend .
docker run -p 8080:8080 --env-file .env navik-backend
```

## Usage

### ì¸ì¦ íë¦„

1. **ì†Œì…œ ë¡œê·¸ì¸**: `GET /oauth2/authorization/{provider}` (google, kakao, naver)
2. ë¡œê·¸ì¸ ì„±ê³µ ì‹œ Access Token + Refresh Token(ì¿ í‚¤) ë°œê¸‰
3. ì´í›„ ìš”ì²­ì— `Authorization: Bearer {accessToken}` í—¤ë” ì²¨ë¶€
4. **í† í° ê°±ì‹ **: `POST /v1/auth/refresh`

### API ìš”ì²­ ì˜ˆì‹œ

```bash
# ì„±ì¥ ë¡œê·¸ ìƒì„±
curl -X POST http://localhost:8080/v1/growth-logs \
  -H "Authorization: Bearer {token}" \
  -H "Content-Type: application/json" \
  -d '{
    "title": "Spring Security í•™ìŠµ",
    "content": "OAuth2 ì¸ì¦ íë¦„ê³¼ JWT í† í° ê´€ë¦¬ë¥¼ í•™ìŠµí–ˆë‹¤",
    "kpiCardId": 1
  }'

# ì›”ë³„ ì„±ì¥ ë¡œê·¸ ì¡°íšŒ
curl http://localhost:8080/v1/growth-logs/monthly?year=2025&month=6 \
  -H "Authorization: Bearer {token}"
```

### í‘œì¤€ ì‘ë‹µ í˜•ì‹

```json
{
  "isSuccess": true,
  "code": "OK",
  "message": "ì„±ê³µ",
  "result": {
    ...
  },
  "timestamp": "2025-06-01T12:00:00"
}
```

## API Reference

Swagger UIë¥¼ í†µí•´ ì „ì²´ API ëª…ì„¸ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

- **ë¡œì»¬**: http://localhost:8080/swagger-ui/index.html
- **í”„ë¡œë•ì…˜**: https://api.navik.kro.kr/swagger-ui/index.html

ì£¼ìš” API ê·¸ë£¹:

| ê·¸ë£¹            | Prefix              | ì„¤ëª…                    |
|---------------|---------------------|-----------------------|
| Auth          | `/v1/auth`          | í† í° ê°±ì‹ , ë¡œê·¸ì•„ì›ƒ           |
| Users         | `/v1/users`         | í”„ë¡œí•„, ì˜¨ë³´ë”©, ë§ˆì´í˜ì´ì§€       |
| Growth Logs   | `/v1/growth-logs`   | ì„±ì¥ ë¡œê·¸ CRUD + AI í‰ê°€    |
| Portfolios    | `/v1/portfolios`    | í¬íŠ¸í´ë¦¬ì˜¤ ë“±ë¡ + AI ë¶„ì„      |
| KPI Cards     | `/v1/kpi-cards`     | KPI ì¹´ë“œ ì¡°íšŒ, Top/Bottom |
| KPI Scores    | `/v1/kpi-scores`    | ë ˆì´ë” ì°¨íŠ¸ ë°ì´í„°            |
| Boards        | `/v1/boards`        | ê²Œì‹œê¸€ CRUD, ì¸ê¸°ê¸€, ê²€ìƒ‰     |
| Comments      | `/v1/comments`      | ëŒ“ê¸€ CRUD               |
| Studies       | `/v1/studies`       | ìŠ¤í„°ë”” ìƒì„±Â·ì°¸ì—¬Â·ì¶”ì²œ          |
| Evaluations   | `/v1/evaluations`   | ë™ë£Œ í‰ê°€                 |
| Recruitments  | `/v1/recruitments`  | ì±„ìš© ê³µê³  ì¶”ì²œ              |
| Goals         | `/v1/goals`         | ê°œì¸ ëª©í‘œ ê´€ë¦¬              |
| Notifications | `/v1/notifications` | ì•Œë¦¼ ì¡°íšŒ                 |

## Server Architecture

![img.png](img.png)

## Project Architecture

```
src/main/java/navik/
â”œâ”€â”€ NavikApplication.java
â”œâ”€â”€ domain/                    # ë„ë©”ì¸ë³„ íŒ¨í‚¤ì§€
â”‚   â”œâ”€â”€ ability/               # ì—­ëŸ‰ ì„ë² ë”©
â”‚   â”œâ”€â”€ board/                 # ì»¤ë®¤ë‹ˆí‹° ê²Œì‹œíŒ
â”‚   â”œâ”€â”€ departments/           # ë¶€ì„œ ê´€ë¦¬
â”‚   â”œâ”€â”€ evaluation/            # ë™ë£Œ í‰ê°€
â”‚   â”œâ”€â”€ goal/                  # ëª©í‘œ ê´€ë¦¬
â”‚   â”œâ”€â”€ growthLog/             # ì„±ì¥ ë¡œê·¸ + AI í‰ê°€ Worker
â”‚   â”œâ”€â”€ job/                   # ì§ë¬´ ì •ë³´
â”‚   â”œâ”€â”€ kpi/                   # KPI ì¹´ë“œÂ·ì ìˆ˜
â”‚   â”œâ”€â”€ notification/          # ì•Œë¦¼
â”‚   â”œâ”€â”€ portfolio/             # í¬íŠ¸í´ë¦¬ì˜¤ ë¶„ì„ Worker
â”‚   â”œâ”€â”€ recruitment/           # ì±„ìš© ê³µê³  ì¶”ì²œ
â”‚   â”œâ”€â”€ study/                 # ìŠ¤í„°ë””
â”‚   â”œâ”€â”€ term/                  # ì•½ê´€
â”‚   â””â”€â”€ users/                 # ì‚¬ìš©ì
â””â”€â”€ global/                    # ê³µí†µ ëª¨ë“ˆ
    â”œâ”€â”€ apiPayload/            # í‘œì¤€ ì‘ë‹µ / ì—ëŸ¬ ì½”ë“œ
    â”œâ”€â”€ auth/                  # JWT + OAuth2 ì„¤ì •
    â”œâ”€â”€ config/                # Security, CORS, Redis, S3, QueryDSL ë“±
    â”œâ”€â”€ converter/             # ë°ì´í„° ë³€í™˜
    â”œâ”€â”€ entity/                # BaseEntity
    â”œâ”€â”€ enums/                 # ê³µí†µ Enum
    â”œâ”€â”€ log/                   # ë¡œê¹…
    â”œâ”€â”€ s3/                    # S3 íŒŒì¼ ì—…ë¡œë“œ
    â””â”€â”€ swagger/               # Swagger ìœ í‹¸
```

ê° ë„ë©”ì¸ íŒ¨í‚¤ì§€ëŠ” `controller / service / repository / entity / dto / docs` êµ¬ì¡°ë¥¼ ë”°ë¦…ë‹ˆë‹¤.

### ë¹„ë™ê¸° Worker ì•„í‚¤í…ì²˜

```
[Client] â†’ [REST API] â†’ [Redis Stream] â†’ [Worker] â†’ [AI Server]
                                              â†“
                                        [DB ê²°ê³¼ ì €ì¥]
```

- ì„±ì¥ ë¡œê·¸ í‰ê°€, í¬íŠ¸í´ë¦¬ì˜¤ ë¶„ì„ì€ Redis Stream ê¸°ë°˜ ë¹„ë™ê¸° Workerë¡œ ì²˜ë¦¬ë©ë‹ˆë‹¤
- WorkerëŠ” poll ë°©ì‹ìœ¼ë¡œ Streamì„ ì†Œë¹„í•˜ë©°, claim ë©”ì»¤ë‹ˆì¦˜ìœ¼ë¡œ ì‹¤íŒ¨í•œ ë©”ì‹œì§€ë¥¼ ì¬ì²˜ë¦¬í•©ë‹ˆë‹¤

## Deployment

GitHub Actionsë¥¼ í†µí•´ ìë™ ë°°í¬ë©ë‹ˆë‹¤.

| ì›Œí¬í”Œë¡œ            | íŠ¸ë¦¬ê±°              | ë™ì‘                                  |
|-----------------|------------------|-------------------------------------|
| `integrate.yml` | `develop` ë¸Œëœì¹˜ PR | í…ŒìŠ¤íŠ¸ ì‹¤í–‰ + merge ì‹œë®¬ë ˆì´ì…˜ ê²€ì¦             |
| `deploy.yml`    | `main` ë¸Œëœì¹˜ push  | JAR ë¹Œë“œ â†’ Docker â†’ ECR push â†’ EC2 ë°°í¬ |

ë°°í¬ í›„ Discord ì›¹í›…ìœ¼ë¡œ ê²°ê³¼ê°€ ì•Œë¦¼ë©ë‹ˆë‹¤.

## Troubleshooting

| ì¦ìƒ                     | í•´ê²°                                                      |
|------------------------|---------------------------------------------------------|
| `vector` íƒ€ì… ê´€ë ¨ SQL ì—ëŸ¬  | PostgreSQLì— `CREATE EXTENSION IF NOT EXISTS vector;` ì‹¤í–‰ |
| OAuth ë¡œê·¸ì¸ ë¦¬ë‹¤ì´ë ‰íŠ¸ ì‹¤íŒ¨     | `.env`ì˜ OAuth Client ID/Secret í™•ì¸ ë° ë¦¬ë‹¤ì´ë ‰íŠ¸ URI ì„¤ì • í™•ì¸     |
| Redis ì—°ê²° ì‹¤íŒ¨            | Redis ì„œë²„ ì‹¤í–‰ ì—¬ë¶€ í™•ì¸ (`redis-cli ping`)                    |
| AI í‰ê°€ê°€ PENDING ìƒíƒœì—ì„œ ë©ˆì¶¤ | AI ì„œë²„(`AI_SERVER_BASE_URL`) ì—°ê²° í™•ì¸ ë° Worker í™œì„±í™” ì—¬ë¶€ í™•ì¸    |

## License

> ë¼ì´ì„ ìŠ¤ ì¶”ê°€ ì˜ˆì •

## Support

- **GitHub Issues**: ë²„ê·¸ ë¦¬í¬íŠ¸ ë° ê¸°ëŠ¥ ìš”ì²­
- **Swagger UI**: API ëª…ì„¸ ë° í…ŒìŠ¤íŠ¸

## Credits

- [Spring Boot](https://spring.io/projects/spring-boot)
- [pgvector](https://github.com/pgvector/pgvector)
- [springdoc-openapi](https://springdoc.org)
